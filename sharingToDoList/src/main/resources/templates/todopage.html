<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <!--<meta name=description content="This site was generated with Anima. www.animaapp.com"/>-->
  <!-- <link rel="shortcut icon" type=image/png href="https://animaproject.s3.amazonaws.com/home/favicon.png" /> -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <link rel="shortcut icon" type="image/png" href="https://animaproject.s3.amazonaws.com/home/favicon.png" />
  <meta name="og:type" content="website" />
  <meta name="twitter:card" content="photo" />
  <link rel="stylesheet" type="text/css" href="/css/todopage.css" />
  <link rel="stylesheet" type="text/css" href="/css/styleguide.css" />
  <link rel="stylesheet" type="text/css" href="/css/globals.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body style="margin: 0; background: #ffffff">
<input type="hidden" id="anPageName" name="page" value="todopage" />
<div class="container-center-horizontal">
  <div class="todopage screen">
    <a href="mainpage" class="align-self-flex-start"
    ><img class="vector-1" src="/img/vector-2.svg" alt="Vector" />
    </a>
    <div class="frame-41">
      <div class="text-64 valign-text-middle">â€œë¹„ìƒê¸ˆ ëª¨ìœ¼ê¸° ëŒ€ì‘ì „â€</div>
      <div class="text-63 valign-text-middle">ğŸŒŸìƒê¸ˆ : 10,000</div>
      <p class="text-65">06 : 36 : 59</p>
    </div>
    <div class="group-80">
      <!--         to- do list code -->
      <div class="searchBox">
        <img class="group-2" src="/img/group-2@2x.png" alt="Group" />
        <input type="button" class="searchBtn btn-all" value="ì „ì²´ : 0">
        <input type="button" class="searchBtn btn-before" value="ì§„í–‰ì¤‘ : 0">
        <input type="button" class="searchBtn btn-after" value="ì™„ë£Œ : 0">
      </div>

      <!-- Todo-List -->
      <div class="listBox">
        <!-- ì‚¬ìš©ìì˜ to-do-list -->
        <div class="addBox">
          <div class="addBox_inner">
            <input type="text" class="addTxt" placeholder="To-do list ì‘ì„±">
            <input type="button" class="addBtn" value="+">
          </div>
        </div>

        <!-- ì „ì²´ì„ íƒ/ì‚­ì œ -->
        <!--            <div class="allCheckBox">-->
        <!--              <label class="allSelect_lb"><input type="checkbox" class="allSelect">ì „ì²´ì„ íƒ</label>-->
        <!--              <a href="javascript:void(0)" class="allDel">ì „ì²´ì‚­ì œ</a>-->
        <!--            </div>-->

        <!-- ëª©ë¡ -->
        <div class="listBox_inner"></div>
      </div>
    </div>
    <div class="group-81">
      <div class="group-container-1">
        <img class="group-2" src="/img/group-2@2x.png" alt="Group" />
        <div class="overlap-group4-1"><div class="text-73 valign-text-middle">ìŠˆí¼ë§¨</div></div>
      </div>
      <ul>
        <li th:each="task : ${todoItems}"> <!--ì´ ì±Œë¦°ì§€ë¥¼ í•¨ê»˜í•˜ëŠ” ë©”ì´íŠ¸ì˜ to_do_list ë‚˜ì—´ -->
          <span th:class="${task.complete == 'ì™„ë£Œ'} ? 'completed-task' : 'incomplete-task'" th:text="${task.details}"></span>
        </li>
      </ul>
      <!--ì‚­ì œ ì˜ˆì • -->
      <!--          <div class="overlap-group2-1">-->
      <!--            <img class="vector" src="/img/vector-2-1.svg" alt="Vector 2" />-->
      <!--            <div class="group">-->
      <!--              <img class="ellipse-2-1" src="/img/ellipse-2-1.svg" alt="Ellipse 2" />-->
      <!--              <div class="text-container">-->
      <!--                <div class="text valign-text-middle">ë¹¨ë˜ ëŒë¦¬ê¸°</div>-->
      <!--                <div class="text-1 valign-text-middle notosanskr-normal-black-16px">ğŸ‘‹</div>-->
      <!--              </div>-->
      <!--            </div>-->
      <!--          </div>-->
      <!--          <div class="group-74">-->
      <!--            <div class="ellipse-3-1"></div>-->
      <!--            <div class="text-76 valign-text-middle notosanskr-normal-black-16px">ì•„ì¹¨ì‹ì‚¬ ì„¤ê±°ì§€</div>-->
      <!--          </div>-->
      <!--          <div class="group-75">-->
      <!--            <div class="ellipse-4"></div>-->
      <!--            <div class="text-2 valign-text-middle notosanskr-normal-black-16px">ì–‘ë§ ê°œê¸°</div>-->
      <!--          </div>-->
      <!--          <div class="overlap-group3-1">-->
      <!--            <div class="ellipse-2-2"></div>-->
      <!--            <div class="text-container-1">-->
      <!--              <div class="text-7 valign-text-middle">+</div>-->
      <!--              <div class="text-7-1 valign-text-middle notosanskr-normal-shady-lady-16px">í•  ì¼ì„ ì¶”ê°€í•´ë³´ì„¸ìš”</div>-->
      <!--            </div>-->
      <!--          </div>-->
      <!--          <img class="rectangle-73 rectangle" src="/img/rectangle-70@2x.png" alt="Rectangle 73" />-->
    </div>
  </div>
</div>
</body>
<script>
  let addBtn = document.querySelector('.addBtn')
let addTxt = document.querySelector('.addTxt')
let listBox_inner = document.querySelector('.listBox_inner')
let delBtnEls = document.querySelectorAll('.delBtn')
let listEls = document.querySelectorAll('.list')
let allBtn = document.querySelector('.btn-all')
let beforeBtn = document.querySelector('.btn-before')
let afterBtn = document.querySelector('.btn-after')
let listCheck = document.querySelectorAll('.listCheck');
let allDel = document.querySelector('.allDel')
let allSelect = document.querySelector('.allSelect')


// ë¦¬ìŠ¤íŠ¸ ì¶”ê°€1 - 'enter'ë²„íŠ¼ìœ¼ë¡œ ì¶”ê°€í•˜ê¸°
addTxt.addEventListener('keyup', function(e) {

    if(e.key === 'Enter') {
        addList()
    }

    checkList()
    delList()
    listCount()

})


// ë¦¬ìŠ¤íŠ¸ ì¶”ê°€2 - ì¶”ê°€(+)ë²„íŠ¼ìœ¼ë¡œ ì¶”ê°€í•˜ê¸°
addBtn.addEventListener('click', function() {

    addList()
    checkList()
    delList()
    listCount()

});


// addTxt ì…ë ¥ì°½ nullê°’ íŒë‹¨
function addList() {
    if (addTxt.value !== "") {
        // listë¥¼ ì¶œë ¥í•  <div> ìš”ì†Œìƒì„±
        let list = document.createElement('div');
        list.setAttribute("class", "list");
        list.innerHTML = `<label class="listLb"><input type="checkbox" class="listCheck">${addTxt.value}</label><button class="delBtn">x</button>`;


        // ì‘ì„±í•œ ë‚´ìš© controllerì˜ add-todoì— ì „ì†¡
        fetch('/add-todo', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: addTxt.value // Send the value of addTxt
        })
        .then(response => response.json())
        .then(data => {
            console.log(data); // Response from the backend
        })
        .catch(error => {
            console.error('Error:', error);
        });

        listBox_inner.appendChild(list);
        addTxt.value = '';
        addTxt.style.borderBottom = '1px solid rgb(163, 155, 155)';

        if (document.querySelector('.notice')) {
            // ê²½ê³  ë©”ì‹œì§€ <div>ê°€ ìƒì„±ë˜ì–´ìˆëŠ” ê²½ìš° - ìš”ì†Œì‚­ì œ(removeChild)
            addBox = document.querySelector('.addBox');
            let notice = document.querySelector('.notice');
            addBox.removeChild(notice);
        }

    } else {

        // í…ìŠ¤íŠ¸ ë¯¸ì…ë ¥ì‹œ ê²½ê³  ë©”ì‹œì§€ ì¶œë ¥í•  <div> ìš”ì†Œìƒì„±
        let noticeEl = document.createElement('div');
        noticeEl.setAttribute('class', 'notice');
        noticeEl.innerHTML = '<span>* ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</span>';

        addTxt.style.borderBottom = '1px solid rgb(201, 65, 65)';

        if (document.querySelector('.notice')) {
            // ê²½ê³  ë©”ì‹œì§€ <div>ê°€ ìƒì„±ë˜ì–´ìˆëŠ” ê²½ìš°
        } else {
            // ê²½ê³  ë©”ì‹œì§€ <div>ê°€ ìƒì„±ë˜ì–´ìˆì§€ ì•Šì€ ê²½ìš° - ìš”ì†Œì¶”ê°€(appendChild)
            addBox = document.querySelector('.addBox');
            addBox.appendChild(noticeEl);
        }
    }
}



// ë¦¬ìŠ¤íŠ¸ ì²´í¬(ì™„ë£Œì²˜ë¦¬)
function checkList() {

    listCheck = document.querySelectorAll('.listCheck')
    let listLb = document.querySelectorAll('.listLb')

    listCheck.forEach((listEl, index) => listEl.addEventListener('click', function(){

        if(listEl.checked == true) {
            listLb[index].style.textDecoration = "line-through"
        } else {
            listLb[index].style.textDecoration = "none"
        }

        listCount();
    }))
}


// ë¦¬ìŠ¤íŠ¸ ì‚­ì œ
function delList() {

    delBtnEls = document.querySelectorAll('.delBtn')
    listEls = document.querySelectorAll('.list')

    delBtnEls.forEach((delEl, index) => delEl.addEventListener('click', function() {

        listEls[index].remove()

    }))

    listCount()

}


// ì „ì²´ì¡°íšŒ
allBtn.addEventListener('click', function() {

    // document.querySelector('.listBox_inner').textContent = ""
    // console.log(document.querySelector('.listBox_inner'))

    listEls = document.querySelectorAll('.list')

    listEls.forEach(listEl => {
        listEl.style.display = ""
    });

})


// ì§„í–‰ì¤‘ ì¡°íšŒ
beforeBtn.addEventListener('click', function() {

    listEls = document.querySelectorAll('.list')

    for(let i=0; i<listCheck.length; i++) {

        if(listCheck[i].checked == true) {
            listEls[i].style.display = "none"
        } else {
            listEls[i].style.display = ""
        }
    }

})


// ì™„ë£Œ ì¡°íšŒ
afterBtn.addEventListener('click', function() {

    listEls = document.querySelectorAll('.list')

    for(let i=0; i<listEls.length; i++) {
        if(listCheck[i].checked == true) {
            listEls[i].style.display = ""
        } else {
            listEls[i].style.display = "none"
        }
    }

})


// ì¡°íšŒ ê±´ìˆ˜
function listCount() {

    let beforeArray = [];
    let afterArray = [];

    // ì „ì²´
    listEls = document.querySelectorAll('.list')

    for(let i=0; i<listEls.length; i++) {   // listCheckë¡œ ë°›ìœ¼ë ¤ë©´ ì¬í• ë‹¹ ëª…ì‹œí•´ì¤˜ì•¼í•¨

        if(listCheck[i].checked == false) {
            // ì§„í–‰ì¤‘
            beforeArray.push(listEls[i])
        }  else {
            // ì™„ë£Œ
            afterArray.push(listEls[i])
        }
    }

    let beforeCount = beforeArray.length
    let afterCount = afterArray.length
    let allCount = beforeCount + afterCount

    allBtn.value = 'ì „ì²´ : ' + allCount
    beforeBtn.value =  'ì§„í–‰ì¤‘ : ' + beforeCount
    afterBtn.value = 'ì™„ë£Œ : ' + afterCount

}


// ì „ì²´ì„ íƒ
allSelect.addEventListener('click', function() {

    listCheck = document.querySelectorAll('.listCheck')
    listLb = document.querySelectorAll('.listLb')

    if(allSelect.checked == true) { // ì „ì²´ì„ íƒ ì²´í¬

        for(let i=0; i<listCheck.length; i++) {
            listCheck[i].checked = true;
            listLb[i].style.textDecoration = "line-through"
        }

    } else {    // ì „ì²´ì„ íƒ í•´ì œ

        for(let i=0; i<listCheck.length; i++) {
            listCheck[i].checked = false;
            listLb[i].style.textDecoration = "none"
        }

    }

    listCount()

})



// ì „ì²´ì‚­ì œ
allDel.addEventListener('click', function() {

    listBox_inner.innerHTML = ''
    allSelect.checked = false
    listCount()

})

</script>
</html>